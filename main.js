(()=>{"use strict";var e,t,o,r,n={26:(e,t,o)=>{o.a(e,(async(e,t)=>{try{var r=o(172),n=o(484);const e=await r.R.getProfileId().then((e=>e)),a=document.querySelector(".places__list"),c=document.querySelector(".popup_type_edit"),i=document.querySelector(".popup_type_new-card"),l=document.querySelector(".popup_type_avatar"),s=document.querySelector(".popup_type_image"),d=s.querySelector(".popup__image"),p=s.querySelector(".popup__caption"),u=s.querySelector(".popup__close");c.classList.add("popup_is-animated"),i.classList.add("popup_is-animated"),s.classList.add("popup_is-animated");const _=function(t){const o=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=o.querySelector(".card__image"),c=o.querySelector(".card__title"),i=o.querySelector(".card__like-button"),l=o.querySelector(".card__like-counter"),h=o.querySelector(".card__delete-button");return h.style.display="none",a.setAttribute("src",t.link),a.addEventListener("click",(()=>{d.setAttribute("src",t.link),p.textContent=t.name,u.addEventListener("click",(()=>n.l.closeModal(s))),n.l.openModal(s)})),t.likes.some((t=>t._id===e))&&i.classList.add("card__like-button_is-active"),t.owner._id==e&&(h.style.display="inline-block",h.addEventListener("click",(e=>{e.target.closest(".card").remove(),r.R.deleteCard(t._id)}))),c.textContent=t.name,i.addEventListener("click",(e=>{e.target.classList.contains("card__like-button_is-active")?(l.textContent=Number(l.textContent)-1,r.R.delLike(t._id).then((e=>e.json())).then((t=>{console.log(t),console.log(e.target.closest(".card")),e.target.closest(".card").parentNode.insertBefore(_(t),e.target.closest(".card"))})).then((t=>e.target.closest(".card").remove()))):(l.textContent=Number(l.textContent)+1,r.R.putLike(t._id).then((e=>e.json())).then((t=>{console.log(t),console.log(e.target.closest(".card")),e.target.closest(".card").parentNode.insertBefore(_(t),e.target.closest(".card"))})).then((t=>e.target.closest(".card").remove()))),e.target.classList.toggle("card__like-button_is-active")})),l.textContent=t.likes.length,o};r.R.getInitialCards().then((e=>{for(let t=1;t<e.length;t++)a.append(_(e[t]))}));const h=c.querySelector(".popup__input_type_name"),y=c.querySelector(".popup__input_type_description"),v=[h,y],m=c.querySelector(".popup__button"),f=document.querySelector(".profile__title"),g=document.querySelector(".profile__description"),S=document.querySelector(".profile__image");r.R.getProfileData().then((e=>{f.textContent=e.name,g.textContent=e.about,S.style.backgroundImage=`url(${e.avatar})`})),document.querySelector(".profile__edit-button").addEventListener("click",(e=>{h.value=f.textContent,y.value=g.textContent,n.l.openModal(c)})),h.addEventListener("input",(e=>n.l.checkValidity(h,m,v))),y.addEventListener("input",(e=>n.l.checkValidity(y,m,v))),c.querySelector(".popup__close").addEventListener("click",(()=>n.l.closeModal(c))),c.querySelector(".popup__form").addEventListener("submit",(e=>{e.preventDefault(),r.R.editProfile(h.value,y.value).then((e=>e.json())).then((e=>{f.textContent=e.name,g.textContent=e.about,S.style.backgroundImage=`url(${e.avatar})`})),n.l.closeModal(c)}));const k=l.querySelector(".popup__input_type_avatar"),b=l.querySelector(".popup__button");k.addEventListener("input",(e=>n.l.checkValidity(k,b,[k]))),l.querySelector(".popup__close").addEventListener("click",(()=>n.l.closeModal(l))),document.querySelector(".profile__edit-avatar-button").addEventListener("click",(e=>{k.value=null,n.l.openModal(l)})),l.querySelector(".popup__close").addEventListener("click",(()=>n.l.closeModal(l))),l.querySelector(".popup__form").addEventListener("submit",(e=>{e.preventDefault(),r.R.editAvatar(k.value).then((e=>e.json())).then((e=>{S.style.backgroundImage=`url(${e.avatar})`,n.l.closeModal(l)}))}));const E=i.querySelector(".popup__input_type_card-name"),L=i.querySelector(".popup__input_type_url"),q=[E,L],C=i.querySelector(".popup__button");E.addEventListener("input",(e=>n.l.checkValidity(E,C,q))),L.addEventListener("input",(e=>n.l.checkValidity(L,C,q))),c.querySelector(".popup__close").addEventListener("click",(()=>n.l.closeModal(c))),document.querySelector(".profile__add-button").addEventListener("click",(e=>{E.value=null,L.value=null,n.l.openModal(i)})),i.querySelector(".popup__close").addEventListener("click",(()=>n.l.closeModal(i))),i.querySelector(".popup__form").addEventListener("submit",(e=>{e.preventDefault(),r.R.addCard(E.value,L.value).then((e=>e.json())).then((e=>{console.log(e),a.append(_(e))})),n.l.closeModal(i)})),t()}catch(e){t(e)}}),1)},172:(e,t,o)=>{o.d(t,{R:()=>r});const r={TOKEN:"7fe8d49a-0c9d-44e2-80e5-d5a3a1e68570",GROUPID:"apf-cohort-202",getProfileData:function(){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/users/me`,{headers:{authorization:this.TOKEN}}).then((e=>e.json()))},getProfileId:function(){return this.getProfileData().then((e=>e._id))},getInitialCards:function(){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/cards`,{headers:{authorization:this.TOKEN}}).then((e=>e.json()))},editProfile:function(e,t){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/users/me`,{method:"PATCH",headers:{authorization:this.TOKEN,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).catch((e=>console.log(e)))},editAvatar:function(e){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/users/me/avatar `,{method:"PATCH",headers:{authorization:this.TOKEN,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).catch((e=>console.log(e)))},addCard:function(e,t){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/cards`,{method:"POST",headers:{authorization:this.TOKEN,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).catch((e=>console.log(e)))},deleteCard:function(e){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/cards/${e}`,{method:"DELETE",headers:{authorization:this.TOKEN}}).catch((e=>console.log(e)))},putLike:function(e){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/cards/likes/${e}`,{method:"PUT",headers:{authorization:this.TOKEN}}).catch((e=>console.log(e)))},delLike:function(e){return fetch(`https://nomoreparties.co/v1/${this.GROUPID}/cards/likes/${e}`,{method:"DELETE",headers:{authorization:this.TOKEN}}).catch((e=>console.log(e)))}}},484:(e,t,o)=>{o.d(t,{l:()=>r});const r={openModal:function(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",(t=>{"Escape"==t.key&&closeModal(e)})),e.addEventListener("click",(t=>{t.target===t.currentTarget&&closeModal(e)}))},closeModal:function(e){e.classList.remove("popup_is-opened")},showInputError:(e,t)=>{const o=document.querySelector(`.popup__error_type_${e.id}`);o.textContent=t,o.classList.add("popup__error_active"),e.classList.add("popup__input_error")},hideInputError:(e,t)=>{const o=document.querySelector(`.popup__error_type_${e.id}`);o.textContent="",o.classList.remove("popup__error_active"),e.classList.remove("popup__input_error")},toggleButton:(e,t)=>{t.some((e=>!e.validity.valid))?(e.classList.add("inactive"),e.disabled=!0):(e.classList.remove("inactive"),e.disabled=!1)},checkValidity:(e,t,o)=>{toggleButton(t,o),e.validity.valid?hideInputError(e,e.validationMessage):showInputError(e,e.validationMessage)}}}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return n[e](o,o.exports,c),o.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",o="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},c.a=(n,a,c)=>{var i;c&&((i=[]).d=-1);var l,s,d,p=new Set,u=n.exports,_=new Promise(((e,t)=>{d=t,s=e}));_[t]=u,_[e]=e=>(i&&e(i),p.forEach(e),_.catch((e=>{}))),n.exports=_,a((n=>{var a;l=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var a=[];a.d=0,n.then((e=>{c[t]=e,r(a)}),(e=>{c[o]=e,r(a)}));var c={};return c[e]=e=>e(a),c}}var i={};return i[e]=e=>{},i[t]=n,i})))(n);var c=()=>l.map((e=>{if(e[o])throw e[o];return e[t]})),s=new Promise((t=>{(a=()=>t(c)).r=0;var o=e=>e!==i&&!p.has(e)&&(p.add(e),e&&!e.d&&(a.r++,e.push(a)));l.map((t=>t[e](o)))}));return a.r?s:c()}),(e=>(e?d(_[o]=e):s(u),r(i)))),i&&i.d<0&&(i.d=0)},c.d=(e,t)=>{for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c(26)})();